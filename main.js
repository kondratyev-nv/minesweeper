!function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1)}([function(t,e){t.exports=function(){"use strict";var t=[];return{add:function(e,n){if("function"!=typeof e)throw new Error("could not add non-function listener");t.push({fn:e,scope:n})},remove:function(e){for(var n=0;n<t.length;n++)if(t[n].fn===e){t.splice(n,1);break}},notify:function(){for(var e=0;e<t.length;e++){var n=t[e];n.fn.apply(n.scope,arguments)}}}}},function(t,e,n){"use strict";n(2);var i=n(3),o=n(5),r=n(6),s=n(8),h=n(9);!function(t,e,n){var u=document.getElementById("minesweeper-canvas"),a=i(10,10,10,h.getRandomInteger),f=new o(a),c=new r(u,10,10);c.openTile.add(f.open,f),c.markTile.add(f.toggleMark,f);new s(u,document.getElementById("minesweeper-status"),f)}()},function(t,e,n){},function(t,e,n){"use strict";var i=n(4);t.exports=function(t,e,n,o){for(var r=[[-1,-1],[-1,0],[-1,1],[0,-1],[0,1],[1,-1],[1,0],[1,1]],s=function(n,i){return 0<=n&&n<t&&0<=i&&i<e},h=function(t,e){u[e][t].value=-1,r.forEach(function(n){return function(t,e){s(t,e)&&u[e][t].value>=0&&(u[e][t].value+=1)}(t+n[0],e+n[1])})},u=[],a=0;a<e;++a){u[a]=[];for(var f=0;f<t;++f)u[a][f]=i(f,a,0)}for(var c=0;c<n;){var l=o(0,t),d=o(0,e);u[d][l].value>=0&&(h(l,d),c+=1)}return{at:function(t,e){return u[e][t]},getNeighborsOf:function(t,e){return r.filter(function(n){return s(t+n[0],e+n[1])}).map(function(n){return u[e+n[1]][t+n[0]]})},width:function(){return t},height:function(){return e},numberOfMines:function(){return n}}}},function(t,e,n){"use strict";t.exports=function(t,e,n){var i=!1,o=!1;return{x:t,y:e,value:n,open:function(){return i=!1,o=!0,this.value},isOpened:function(){return o},mark:function(){i=!0},unmark:function(){i=!1},isMarked:function(){return i}}}},function(t,e,n){"use strict";var i=n(0);function o(t){this.field=t,this.marksLeft=t.numberOfMines(),this.gameCompleted=!1,this.onMineFound=i(),this.onTileOpened=i(),this.onMarkTile=i(),this.onUnmarkTile=i(),this.onWin=i()}o.prototype.width=function(){return this.field.width()},o.prototype.height=function(){return this.field.height()},o.prototype.getTotalMinesCount=function(){return this.field.numberOfMines()},o.prototype.getMarkInfo=function(){return{left:this.marksLeft,total:this.getTotalMinesCount()}},o.prototype.isInsideField=function(t,e){return 0<=t&&t<this.width()&&0<=e&&e<this.height()},o.prototype.open=function(t,e){var n=this;if(this.isInsideField(t,e)&&!this.gameCompleted&&!this.field.at(t,e).isOpened()){this.unmarkTile(t,e);var i=this.field.at(t,e).open();if(i<0){this.onMineFound.notify(t,e);for(var o=0;o<this.height();++o)for(var r=0;r<this.width();++r)this.open(r,o)}else this.onTileOpened.notify(t,e,i),0===i&&this.field.getNeighborsOf(t,e).filter(function(t){return!t.isMarked()}).forEach(function(t){return n.open(t.x,t.y)});this.checkComplete()}},o.prototype.toggleMark=function(t,e){this.isInsideField(t,e)&&(this.gameCompleted||this.field.at(t,e).isOpened()||(this.field.at(t,e).isMarked()?this.unmarkTile(t,e):this.marksLeft>0&&(this.field.at(t,e).mark(),this.marksLeft-=1,this.onMarkTile.notify(t,e),this.checkComplete())))},o.prototype.unmarkTile=function(t,e){this.field.at(t,e).isMarked()&&(this.field.at(t,e).unmark(),this.marksLeft+=1,this.onUnmarkTile.notify(t,e))},o.prototype.checkComplete=function(){if(0===this.marksLeft){for(var t=0,e=0;e<this.width();++e)for(var n=0;n<this.height();++n){if(this.field.at(e,n).isMarked()&&this.field.at(e,n).value>=0)return;this.field.at(e,n).isOpened()&&t++}t===this.width()*this.height()-this.getTotalMinesCount()&&(this.gameCompleted=!0,this.onWin.notify())}},t.exports=o},function(t,e,n){"use strict";var i=n(7);function o(t,e,n){var i=this;this.canvas=t,this.nx=e,this.ny=n,this.cw=this.canvas.clientWidth,this.ch=this.canvas.clientHeight,this.canvas.addEventListener("click",function(t){return i.onLeftButtonClick(t)},!1),this.canvas.addEventListener("contextmenu",function(t){t.preventDefault(),i.onRightButtonClick(t)},!1)}o.prototype=new i,o.prototype.constructor=o,o.prototype.getTile=function(t,e){return{x:this.nx*t/this.cw|0,y:this.ny*e/this.ch|0}},o.prototype.onLeftButtonClick=function(t){var e=t.offsetX,n=t.offsetY,i=this.getTile(e,n);this.openTile.notify(i.x,i.y)},o.prototype.onRightButtonClick=function(t){var e=t.offsetX,n=t.offsetY,i=this.getTile(e,n);this.markTile.notify(i.x,i.y)},t.exports=o},function(t,e,n){"use strict";var i=n(0);function o(){this.openTile=i(),this.markTile=i()}o.prototype={constructor:o,openTile:null,markTile:null},t.exports=o},function(t,e,n){"use strict";function i(t,e,n){var i=this;this.canvas=t,this.statusText=e,this.ctx=t.getContext("2d"),this.minesweeper=n,this.w=n.width(),this.h=n.height(),this.n=n.getTotalMinesCount(),n.onMineFound.add(function(t,e){return i.onMineFound(t,e)}),n.onTileOpened.add(function(t,e,n){return i.fillTile(t,e,n,"#b5e853")}),n.onMarkTile.add(function(t,e){return i.fillTile(t,e,"üìç")}),n.onUnmarkTile.add(function(t,e){return i.clearTile(t,e)}),n.onWin.add(function(){return i.showMessage("You won! üéâ")}),this.drawMesh(this.canvas.width,this.canvas.height,this.canvas.width/this.w,this.canvas.height/this.h)}i.prototype.showMessage=function(t){this.statusText.innerHTML=t},i.prototype.showMarkInfo=function(){var t=this.minesweeper.getMarkInfo();this.showMessage("Marks left: "+t.left+" of "+t.total)},i.prototype.drawMesh=function(t,e,n,i){this.ctx.strokeStyle="#b5e853",this.ctx.lineWidth=2;for(var o=0;o<=t;o+=n)this.ctx.moveTo(o,0),this.ctx.lineTo(o,e);for(var r=0;r<=e;r+=i)this.ctx.moveTo(0,r),this.ctx.lineTo(t,r);this.ctx.stroke(),this.showMarkInfo()},i.prototype.getPosition=function(t,e){var n=this.canvas.width/this.w,i=this.canvas.height/this.h;return{x:t*n,y:e*i,w:n,h:i}},i.prototype.onMineFound=function(t,e){this.fillTile(t,e,"üí•"),this.showMessage("You lost!")},i.prototype.fillTile=function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"#000000",o=this.getPosition(t,e);this.ctx.fillStyle=i,this.ctx.font='bold 30px Monaco, "Bitstream Vera Sans Mono", "Lucida Console", Terminal, monospace',this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.clearRect(o.x,o.y,o.w,o.h),this.ctx.fillText(n,o.x+o.w/2,o.y+o.h/2),this.ctx.stroke(),this.showMarkInfo()},i.prototype.clearTile=function(t,e){var n=this.getPosition(t,e);this.ctx.clearRect(n.x,n.y,n.w,n.h),this.ctx.stroke(),this.showMarkInfo()},t.exports=i},function(t,e,n){"use strict";t.exports={getRandomInteger:function(t,e){return Math.floor(Math.random()*(e-t))+t}}}]);